var rides = require('config/ridemodel');
var user = require('config/models');
var gcm = require('node-gcm');
exports.addrequest = function(callback) {
 
// var gcm = require('../lib/node-gcm');

var message = new gcm.Message();

message.addData('message', 'Shashank has requested to travel with you on - 23-sep-2015 , from Hall-3 to CNB . Tab to Call and confirm ');
// message.addNotification('title', 'Hello');
// message.addNotification('icon', 'ic_launcher');
// message.addNotification('body', 'World');
// {
//     "to": "/topics/foo-bar",
//     "data": {
//       "message": "This is a GCM Topic Message!",
//      }
//   }

//Replace your mobile device registration Id here
var regIds = ['APA91bHk3MP8ekrhhKDpve266ji9eETRyWlPiDcJ53SK0t2CE5OYoO52ZqCTIXYVvhWlXr3KGx-0BzNc2jPKgIplCbwLKrj9raLFHHv6s4-IR9Rf9QU2ugWCqUG68aDK5hGlUZ83ILk7'];
//Replace your developer API key with GCM enabled here
var sender = new gcm.Sender('AIzaSyC_0lcCf28lgrOxtXoJTIVPEA4ivgXxTFw');

sender.send(message, regIds, function (err, result) {
    if(err) {
      console.error(err);
    } else {
      console.log(result);
    }
});
	    callback({'res':true,'response':"Request Sent"});

	// user.find({_id:ID},function(err,users){
	// 	var len = users.length;
	// 	var i = 0;
	// 	while(len == 1 && users[0].recievedrequest[i]=="null"){
	// 	users[0].recievedrequest[i] = token;
	//     callback({'res':true,'response':"Request Sent"});
	//     i++;
	// 	}
	// });
}